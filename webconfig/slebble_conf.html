<!DOCTYPE html><html>	<head>		<title>Configurable</title>		<meta charset="UTF-8">		<meta name="viewport" content="width=device-width, initial-scale=1">				<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css" />		<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>		<script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>				<script>			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)			})(window,document,'script','//www.google-analytics.com/analytics.js','ga');			ga('create', 'UA-51591303-1', 'mysliceofpi.se');			ga('send', 'pageview');		</script>	</head>	<body>		<div data-role="page" id="main">			<div data-role="header">				<h1>Slebble Config</h1>			</div>						<div class="adding">			</div>						<a href="#search" type="button">Add</a>			<button type="cancel" id="cancel">Cancel</button>			<button type="submit" id="reset">Reset</button>			<button type="submit" id="submit">Submit</button>		</div>		<div data-role="page" id="search">					<input type="text" name="search" id="search-field" data-icon="search" placeholder="Search for a station">						<a href="#results" type="button" id="search-btn">Search</a>			<a href="#main" type="button">Back</a>				</div>				<div data-role="page" id="results">					<div data-role="header">				<h1>Results</h1>			</div>			<div class="results">			</div>						<a href="#search" class="results-back" type="button">Back</a>				</div>				<script>							function version() {				var ver = purl().param('version');				return ver;			}					var nr = 0;					function add(elem) {				if(nr != 5) {					nr++;					var name = $(elem).text();					var json = $(elem).next().text() + ",";					$(".adding").append('<div><h3>' + name + '</h3><p style="display: none;">' + json + '</p></div>');					$(".results").children("div").remove();				}			}			function saveOptions() {							var options = {					"route": [						{							"from" : "Daltorpsvägen",							"locationid" : "7466565"						},						{							"from" : "Lövholmenvägen",							"locationid" : "7469205"						},						{							"from" : "Kista",							"locationid" : "7412883"						},						{							"from" : "Spånga station",							"locationid" : "7400764"						},					]				};				//return options;								var options = $(".adding").children().children("p").text();				options = '{"route": [' + options.substring(0, options.length - 1) + ']}';								return options;			}						$().ready(function() {											$("#cancel").click(function() {					document.location = "pebblejs://close";				});								$("#reset").click(function() {					document.location = "pebblejs://close#reset";				});				$("#submit").click(function() {					var location = "pebblejs://close#" + encodeURIComponent(saveOptions());					console.log("Warping to: " + location);					console.log(location);					document.location = location;				});				$(".results-back").click(function() {					$(".results").children("div").remove();				});								$("#search-btn").click(function() {									var from = $('#search-field').val();					var response;					var req = new XMLHttpRequest();					req.open('GET', 						'http://mysliceofpi.se/slebble/slebble_conf_1_0_0.php?from=' + from, 						false					);										req.onload = function(e) {											if (req.readyState == 4) {							if(req.status == 200) {															//console.log(req.responseText);								response = JSON.parse(req.responseText);																if( Object.prototype.toString.call( response.findlocationresult.from.location ) === '[object Array]' ) {									for(var i = 0; i < response.findlocationresult.from.location.length; i++) {										$( ".results" ).prepend('<div><a href="#main" type="button" class="ui-btn add-btn" onclick="add(this);">' + response.findlocationresult.from.location[i].displayname + '</a><p style="display: none;">{"from" : "' + response.findlocationresult.from.location[i].displayname +'","locationid" : "'+ response.findlocationresult.from.location[i].locationid +'"}</p></div>');									}								} else {									$( ".results" ).append('<div><a href="#main" type="button" class="ui-btn add-btn" onclick="add(this);">' + response.findlocationresult.from.location.displayname + '</a><p style="display: none;">{"from" : "' + response.findlocationresult.from.location.displayname +'","locationid" : "'+ response.findlocationresult.from.location.locationid +'"}</p></div>');								}															}							else {								console.log("Error");								console.log(req.status);							}						}											};					req.send(null);									});							});					</script>									<script src="purl/purl.js"></script>		</body></html>